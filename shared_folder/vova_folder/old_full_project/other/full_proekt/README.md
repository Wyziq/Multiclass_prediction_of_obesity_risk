# Obesity Risk Classification

## Описание проекта

Данный проект посвящён задаче классификации риска ожирения.
Цель проекта — научиться предсказывать тип ожирения человека
на основе анкетных данных и физических характеристик
с использованием методов машинного обучения.

Проект выполнен в рамках учебной работы и предназначен
для изучения базовых этапов анализа данных и машинного обучения.

---

## Используемые данные

В проекте используется датасет ObesityDataSet, который содержит
информацию о человеке, включая:
- возраст, рост и вес,
- пищевые привычки,
- уровень физической активности,
- образ жизни.

Целевая переменная — `NObeyesdad`, которая определяет тип ожирения.

Исходные данные находятся в папке `data/raw`.

---

## Структура проекта

full_proekt/
│
├── README.md
├── requirements.txt
├── .gitignore
│
├── data/                          # Данные
│   ├── raw/                       # Исходные данные
│   │   └── ObesityDataSet.csv
│   └── processed/                 # Обработанные датасеты (варианты)
│       ├── 01_full_with_height_weight.csv
│       ├── 02_with_bmi.csv
│       ├── 03_no_height.csv
│       ├── 04_no_weight.csv
│       ├── 05_no_height_no_weight.csv
│       └── 06_only_height_weight.csv
│
├── notebooks/                     # Ноутбуки (EDA + эксперименты + модели)
│   ├── EDA_obesity_risk.ipynb
│   ├── model_experiments.ipynb
│   ├── legacy_logreg.ipynb
│   ├── legacy_svm.ipynb
│   ├── model_Random_Forest.ipynb
│   └── CatBoost.ipynb
│
├── src/                           # Исходный код проекта
│   ├── init.py
│   ├── data_preprocessing.py      # Предобработка + генерация вариантов датасета
│   ├── models_registry.py         # Реестр моделей: logreg/svm/rf/catboost
│   ├── train.py                   # Обучение (CV на train) + сохранение модели
│   ├── predict.py                 # Предсказания по сохранённой модели
│   ├── utils.py                   # Вспомогательные функции (если используются)
│   └── generate_prepared_data.py  # (если есть) генерация prepared_data.csv для старых ноутбуков
│
├── models/                        # Сохранённые модели
│   └── best_model.joblib          # появляется после обучения
│
└── reports/                       # Отчёты и результаты
    ├── final_report.md            # финальный отчёт (если есть)
    ├── metrics.json               # метрики после обучения (создаёт train.py)
    ├── models_added.md            # памятка: какие модели добавлены и как запускать
    └── figures/                   # картинки из EDA
        ├── correlation_heatmap.png
        ├── numeric_histograms.png
        └── target_distribution.png

---

## Анализ данных (EDA)

В ноутбуке `EDA_obesity_risk.ipynb` проводится разведочный анализ данных:
- первичный обзор датасета,
- анализ распределения целевой переменной,
- анализ числовых и категориальных признаков,
- формирование гипотез о влиянии признаков на риск ожирения.

Результаты EDA используются при дальнейшей предобработке данных.

---

## Предобработка данных

Предобработка данных реализована в файле `src/data_preprocessing.py` и включает:
- кодирование категориальных признаков,
- обработку бинарных и порядковых признаков,
- создание новых признаков (например, индекс массы тела BMI),
- подготовку данных для обучения моделей.

Обработанные данные сохраняются в папку `data/processed`.

---

## Модели машинного обучения

В проекте рассматриваются следующие модели машинного обучения:
- Logistic Regression,
- Random Forest,
- Support Vector Machine (SVM).

Модели сравниваются с помощью кросс-валидации.
Для оценки качества используется метрика `f1_macro`,
так как классы распределены неравномерно.

---

## Запуск проекта

Для установки зависимостей необходимо выполнить:

pip install -r requirements.txt

Обучение модели:

python -m src.train

---

## Выводы

В рамках проекта был проведён анализ данных,
реализована предобработка и обучены несколько моделей
машинного обучения для задачи классификации риска ожирения.
Проект позволил закрепить основные навыки работы с данными
и построения моделей машинного обучения.
